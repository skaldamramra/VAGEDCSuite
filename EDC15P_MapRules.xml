<?xml version="1.0" encoding="utf-8"?>
<!--
  EDC15P Map Detection Rules

  This file defines the rules for detecting and naming maps in EDC15P binary files.
  The detection engine evaluates these rules against potential maps found in the binary.

  Structure:
  <MapRules ecuType="EDC15P" version="2.0">

    <MapRule priority="100" id="unique_id">
      <Description>Human-readable description</Description>

      <Conditions>
        All conditions must match for the rule to apply.

        Basic Conditions:
        <Length>570</Length>                  - Exact length in bytes
        <Length min="500" max="600" />        - Length range

        <XAxisID high="0xC5" />               - X-axis ID high byte (e.g., 0xC5 for 0xC5EC)
        <XAxisID exact="0xC5EC" />            - Exact X-axis ID
        <YAxisID high="0xEC" />               - Y-axis ID high byte

        <XAxisLength>19</XAxisLength>         - X-axis length (number of points)
        <YAxisLength>15</YAxisLength>         - Y-axis length

        <MapSelector numRepeats="10" />       - For maps with selectors (e.g., SOI)

        Advanced Conditions (v2.0):
        <ByteCheck address="y_axis_address" offset="0" expected="0x00" op="eq" />
                                                      - Check raw byte at address
                                                      - address: "y_axis_address", "x_axis_address", "flash_start_address", or "+offset"/"-offset"
                                                      - op: "eq", "ne", "lt", "le", "gt", "ge"

        <AxisValueCheck axis="Y" comparison="lt" value="4000" checkType="max" />
                                                      - Check actual axis data values at runtime
                                                      - axis: "X", "Y", or "Z"
                                                      - comparison: "lt", "le", "gt", "ge", "eq", "ne"
                                                      - checkType: "max" (maximum value) or "min" (minimum value)

        <MapSelectorProperty property="NumRepeats" comparison="eq" value="10" />
                                                      - Check MapSelector properties
                                                      - property: "NumRepeats", "MapIndexes.Length", "MapIndexes[0]"
                                                      - comparison: "eq", "ne", "lt", "le", "gt", "ge"

        <CodeBlock id="1,2,3" type="Manual" />         - Check code block context
                                                      - id: comma-separated list of code block IDs
                                                      - type: "Automatic", "Manual", "4x4"

        Logical Operators:
        <Or>
          <Conditions>...</Conditions>
          <Conditions>...</Conditions>
        </Or>
        <And>
          <Conditions>...</Conditions>
          <Conditions>...</Conditions>
        </And>
      </Conditions>

      <Metadata>
        Properties to assign to the detected map.

        <Category>Detected maps</Category>
        <Subcategory>Fuel</Subcategory>

        <Name>Map Name</Name>                 - Static name
        <Name sequential="true" baseName="Injector duration" codeBlockScoped="true" />
                                              - Sequential naming (e.g., "Injector duration 00", "01")
                                              - codeBlockScoped: if true, counts only within same code block

        <ConditionalTemplate>
          <When conditionType="MapSelectorExists">
            <Template>Smoke limiter {temperature} °C</Template>
          </When>
          <When conditionType="default">
            <Template>Smoke limiter</Template>
          </When>
        </ConditionalTemplate>

        <Correction>0.01</Correction>         - Z-axis correction factor
        <Offset>0</Offset>                    - Z-axis offset

        <XAxis>
          <Description>Engine speed</Description>
          <Units>rpm</Units>
          <Correction>1.0</Correction>
          <Offset>0</Offset>
        </XAxis>

        <YAxis>...</YAxis>
        <ZAxis>...</ZAxis>
      </Metadata>
    </MapRule>
  </MapRules>
-->
<MapRules ecuType="EDC15P" version="2.0">
  
  <!-- 1. Launch Control -->
  <MapRule priority="100" id="launch_control_700">
    <Description>
      Launch control map - 25x14 dimension (700 bytes)
    </Description>
    <Conditions>
      <Length>700</Length>
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category>
      <Subcategory>Misc</Subcategory>
      <Name>Launch control map (XML)</Name>
      <Correction>0.01</Correction>
      <XAxis>
        <Description>Engine speed (rpm)</Description>
        <Units>rpm</Units>
      </XAxis>
      <YAxis>
        <Description>Approx. vehicle speed (km/h)</Description>
        <Units>km/h</Units>
        <Correction>0.156250</Correction>
      </YAxis>
      <ZAxis>
        <Description>IQ limit</Description>
      </ZAxis>
    </Metadata>
  </MapRule>

  <!-- 1.1 SVRL (Single Value Rev Limiter) -->
  <MapRule priority="102" id="svrl_sequence">
    <Description>SVRL (Single Value Rev Limiter) - Detected by byte sequence</Description>
    <Conditions>
      <Length>2</Length>
      <ByteCheck address="flash_start_address" offset="-2" expected="0x00" op="eq" />
      <ByteCheck address="flash_start_address" offset="-1" expected="0x0E" op="eq" />
      <ByteCheck address="flash_start_address" offset="2" expected="0x32" op="eq" />
      <ByteCheck address="flash_start_address" offset="3" expected="0x00" op="eq" />
      <ByteCheck address="flash_start_address" offset="4" expected="0x70" op="eq" />
      <ByteCheck address="flash_start_address" offset="5" expected="0x17" op="eq" />
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category>
      <Subcategory>Limiters</Subcategory>
      <Name>SVRL (Single Value Rev Limiter) (XML)</Name>
      <ZAxis>
        <Description>Engine speed (rpm)</Description>
      </ZAxis>
    </Metadata>
  </MapRule>

  <!-- 1.2 SVBL (Single Value Boost Limiter) - Sequence 1 -->
  <MapRule priority="103" id="svbl_sequence_1">
    <Description>SVBL (Single Value Boost Limiter) - Sequence 1 (Legacy:353)</Description>
    <Conditions>
      <Length>2</Length>
      <ByteCheck address="flash_start_address" offset="-16" expected="0xD2" op="eq" />
      <ByteCheck address="flash_start_address" offset="-15" expected="0x00" op="eq" />
      <ByteCheck address="flash_start_address" offset="-14" expected="0xFC" op="eq" />
      <ByteCheck address="flash_start_address" offset="-13" expected="0x03" op="eq" />
      <ByteCheck address="flash_start_address" offset="-8" expected="0x04" op="eq" />
      <ByteCheck address="flash_start_address" offset="-7" expected="0x00" op="eq" />
      <ByteCheck address="flash_start_address" offset="-3" expected="0xC3" op="eq" />
      <ByteCheck address="flash_start_address" offset="-2" expected="0x00" op="eq" />
      <ByteCheck address="flash_start_address" offset="-1" expected="0x00" op="eq" />
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category>
      <Subcategory>Limiters</Subcategory>
      <Name>SVBL Boost limiter (XML)</Name>
      <ZAxis><Description>Boost pressure (mbar)</Description></ZAxis>
    </Metadata>
  </MapRule>

  <!-- 1.3 SVBL (Single Value Boost Limiter) - Sequence 2 -->
  <MapRule priority="104" id="svbl_sequence_2">
    <Description>SVBL (Single Value Boost Limiter) - Sequence 2 (Legacy:300)</Description>
    <Conditions>
      <Length>2</Length>
      <ByteCheck address="flash_start_address" offset="2" expected="0xDF" op="eq" />
      <ByteCheck address="flash_start_address" offset="3" expected="0x7A" op="eq" />
      <ByteCheck address="flash_start_address" offset="4" expected="0x28" op="eq" />
      <ByteCheck address="flash_start_address" offset="5" expected="0x00" op="eq" />
      <ByteCheck address="flash_start_address" offset="10" expected="0xDF" op="eq" />
      <ByteCheck address="flash_start_address" offset="11" expected="0x7A" op="eq" />
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category>
      <Subcategory>Limiters</Subcategory>
      <Name>SVBL Boost limiter (XML)</Name>
      <ZAxis><Description>Boost pressure (mbar)</Description></ZAxis>
    </Metadata>
  </MapRule>

  <!-- 2. BIP SOI Correction (Priority before Generic ID) -->
  <MapRule priority="105" id="bip_soi_correction_160">
    <Description>
      BIP SOI Correction Map (zmwBPKorKF) - 10x8 dimension (160 bytes)
      Based on legacy EDC15PFileParser.cs:2555
    </Description>
    <Conditions>
      <Length>160</Length>
      <XAxisLength>10</XAxisLength>
      <YAxisLength>8</YAxisLength>
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category>
      <Subcategory>Fuel</Subcategory>
      <Name>BIP SOI Correction Map (XML)</Name>
      <Correction>0.00390625</Correction>
      <XAxis>
        <Description>Crankshaft degrees</Description>
        <Units>°BTDC</Units>
        <Correction>0.023437</Correction>
        <Offset>-78</Offset>
      </XAxis>
      <YAxis>
        <Description>Engine speed (rpm)</Description>
        <Units>rpm</Units>
      </YAxis>
      <ZAxis>
        <Description>BIP calculation</Description>
      </ZAxis>
    </Metadata>
  </MapRule>

  <!-- 2.1 BIP Basic characteristic line -->
  <MapRule priority="106" id="bip_basic_line">
    <Description>BIP Basic characteristic line - Detected by signature (Legacy:914)</Description>
    <Conditions>
      <Length>20</Length>
      <XAxisID exact="0xC5D6" />
      <ByteCheck address="flash_start_address" offset="-22" expected="0x0A" op="eq" />
      <ByteCheck address="flash_start_address" offset="-21" expected="0x00" op="eq" />
      <ByteCheck address="flash_start_address" offset="-20" expected="0x58" op="eq" />
      <ByteCheck address="flash_start_address" offset="-19" expected="0x01" op="eq" />
      <ByteCheck address="flash_start_address" offset="-18" expected="0x89" op="eq" />
      <ByteCheck address="flash_start_address" offset="-17" expected="0x01" op="eq" />
      <ByteCheck address="flash_start_address" offset="-16" expected="0xBA" op="eq" />
      <ByteCheck address="flash_start_address" offset="-15" expected="0x01" op="eq" />
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category>
      <Subcategory>Fuel</Subcategory>
      <Name>BIP Basic characteristic line (XML)</Name>
      <XAxis>
        <Description>Battery voltage</Description>
        <Units>V</Units>
        <Correction>0.0203147</Correction>
      </XAxis>
      <ZAxis>
        <Description>Time in microseconds</Description>
      </ZAxis>
    </Metadata>
  </MapRule>

  <!-- 2.2 BIP temperature correction -->
  <MapRule priority="107" id="bip_temp_correction">
    <Description>BIP temperature correction - Detected by signature (Legacy:935)</Description>
    <Conditions>
      <Length>20</Length>
      <XAxisID exact="0xC1BE" />
      <ByteCheck address="flash_start_address" offset="-22" expected="0x0A" op="eq" />
      <ByteCheck address="flash_start_address" offset="-21" expected="0x00" op="eq" />
      <ByteCheck address="flash_start_address" offset="-20" expected="0x4D" op="eq" />
      <ByteCheck address="flash_start_address" offset="-19" expected="0x09" op="eq" />
      <ByteCheck address="flash_start_address" offset="-18" expected="0xE3" op="eq" />
      <ByteCheck address="flash_start_address" offset="-17" expected="0x09" op="eq" />
      <ByteCheck address="flash_start_address" offset="-16" expected="0x47" op="eq" />
      <ByteCheck address="flash_start_address" offset="-15" expected="0x0A" op="eq" />
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category>
      <Subcategory>Fuel</Subcategory>
      <Name>BIP temperature correction (XML)</Name>
      <Correction>0.000244</Correction>
      <XAxis>
        <Description>Temperature</Description>
        <Units>°C</Units>
        <Correction>0.1</Correction>
        <Offset>-273.1</Offset>
      </XAxis>
      <ZAxis>
        <Description>Crankshaft degrees</Description>
      </ZAxis>
    </Metadata>
  </MapRule>

  <!-- 2.3 MAP/MAF Switch -->
  <MapRule priority="107" id="map_maf_switch">
    <Description>MAP/MAF switch (Legacy:320, 394)</Description>
    <Conditions>
      <Length>2</Length>
      <ByteCheck address="flash_start_address" offset="-2" expected="0x41" op="eq" />
      <ByteCheck address="flash_start_address" offset="-1" expected="0x02" op="eq" />
      <ByteCheck address="flash_start_address" offset="2" expected="0x00" op="eq" />
      <ByteCheck address="flash_start_address" offset="3" expected="0x01" op="eq" />
      <ByteCheck address="flash_start_address" offset="4" expected="0x01" op="eq" />
      <ByteCheck address="flash_start_address" offset="5" expected="0x00" op="eq" />
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category>
      <Subcategory>Switches</Subcategory>
      <Name>MAP/MAF switch (0 = MAF, 257 = MAP) (XML)</Name>
      <ZAxis><Description>(0 = MAF, 257 = Intake Boost pressure, 1 = Intake Atm Pressure)</Description></ZAxis>
    </Metadata>
  </MapRule>

  <MapRule priority="107" id="left_foot_brake_switch">
    <Description>Left Foot Brake Switch (Legacy:780)</Description>
    <Conditions>
      <Length>2</Length>
      <ByteCheck address="flash_start_address" offset="-5" expected="0x27" op="eq" />
      <ByteCheck address="flash_start_address" offset="-4" expected="0x00" op="eq" />
      <ByteCheck address="flash_start_address" offset="-3" expected="0x00" op="eq" />
      <ByteCheck address="flash_start_address" offset="-2" expected="0x64" op="eq" />
      <ByteCheck address="flash_start_address" offset="-1" expected="0x00" op="eq" />
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category>
      <Subcategory>Switches</Subcategory>
      <Name>Left Foot Brake Switch (1 = ON (default), O = OFF) (XML)</Name>
    </Metadata>
  </MapRule>

  <!-- 3. Start of Injection (SOI) - Repeat 10 -->
  <MapRule priority="108" id="soi_map_448_temp">
    <Description>
      Start of Injection (SOI) map - 16x14 dimension (448 bytes)
      Based on legacy EDC15PFileParser.cs:1402
    </Description>
    <Conditions>
      <Length>448</Length>
      <MapSelector numRepeats="10" />
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category>
      <Subcategory>Fuel</Subcategory>
      <Name sequential="false" codeBlockScoped="true">
        <ConditionalTemplate>
          <When conditionType="MapSelectorExists">
            <Template>Start of injection (SOI) {temperature} deg C (XML)</Template>
          </When>
          <When conditionType="default">
            <Template>Start of injection (SOI) (XML)</Template>
          </When>
        </ConditionalTemplate>
      </Name>
      <Correction>-0.023437</Correction>
      <Offset>78</Offset>
      <XAxis>
        <Description>IQ (mg/stroke)</Description>
        <Units>mg/st</Units>
        <Correction>0.01</Correction>
      </XAxis>
      <YAxis>
        <Description>Engine speed (rpm)</Description>
        <Units>rpm</Units>
      </YAxis>
      <ZAxis>
        <Description>Start position (degrees BTDC)</Description>
      </ZAxis>
    </Metadata>
  </MapRule>

  <!-- 3.1 Start IQ -->
  <MapRule priority="112" id="start_iq_generic">
    <Description>Start IQ maps (Legacy:2399, 2514, 2596)</Description>
    <Conditions>
      <Or>
        <Conditions><Length>180</Length><XAxisLength>9</XAxisLength><YAxisLength>10</YAxisLength></Conditions>
        <Conditions><Length>162</Length><XAxisLength>9</XAxisLength><YAxisLength>9</YAxisLength></Conditions>
        <Conditions><Length>144</Length><XAxisLength>8</XAxisLength><YAxisLength>9</YAxisLength></Conditions>
      </Or>
      <XAxisID high="0xEC" /><YAxisID high="0xC1" />
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category><Subcategory>Fuel</Subcategory>
      <Name sequential="true" baseName="Start IQ (XML)" codeBlockScoped="true" />
      <Correction>0.01</Correction>
      <XAxis><Description>Temperature</Description><Units>°C</Units><Correction>0.1</Correction><Offset>-273.1</Offset></XAxis>
      <YAxis><Description>Engine speed (rpm)</Description><Units>rpm</Units></YAxis>
      <ZAxis><Description>Requested IQ (mg)</Description></ZAxis>
    </Metadata>
  </MapRule>

  <!-- 3.2 Fuel volume correction map -->
  <MapRule priority="115" id="fuel_volume_correction">
    <Description>Fuel volume correction map (mrwK_KF) (Legacy:2581)</Description>
    <Conditions>
      <Length>144</Length><XAxisLength>9</XAxisLength><YAxisLength>8</YAxisLength>
      <XAxisID high="0xEC" /><YAxisID high="0xC0" />
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category><Subcategory>Fuel</Subcategory>
      <Name>Fuel volume correction map (XML)</Name>
      <Correction>0.002441</Correction>
      <XAxis><Description>IQ (mg/stroke)</Description><Units>mg/st</Units><Correction>0.01</Correction></XAxis>
      <YAxis><Description>Engine speed (rpm)</Description><Units>rpm</Units></YAxis>
      <ZAxis><Description>IQ correction per 100K</Description></ZAxis>
    </Metadata>
  </MapRule>

  <!-- 3.3 Selector for injector duration -->
  <MapRule priority="118" id="injector_duration_selector">
    <Description>Selector for injector duration (Legacy:4983)</Description>
    <Conditions>
      <Length>12</Length><XAxisLength>6</XAxisLength><YAxisLength>1</YAxisLength>
      <XAxisID exact="0xECB4" />
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category><Subcategory>Fuel</Subcategory>
      <Name>Selector for injector duration (XML)</Name>
      <Correction>0.00390625</Correction>
      <XAxis><Description>Engine speed</Description><Units>rpm</Units></XAxis>
      <YAxis><Description>SOI</Description><Units>°BTDC</Units><Correction>-0.023437</Correction><Offset>78</Offset></YAxis>
      <ZAxis><Description>Map index</Description></ZAxis>
    </Metadata>
  </MapRule>

  <!-- 4. Length 448 Corrections (Height, Dynamic, IAT) -->
  <MapRule priority="109" id="injection_height_corr_448">
    <Conditions>
      <Length>448</Length>
      <MapSelector numRepeats="6" />
      <XAxisID high="0xF9" /><YAxisID high="0xEB" />
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category><Subcategory>Fuel</Subcategory>
      <Name sequential="true" baseName="Injection correction map (Height) (XML)" codeBlockScoped="true" />
      <Correction>0.023437</Correction>
      <XAxis><Description>Requested Quantity mg/stroke</Description><Units>mg/st</Units><Correction>0.01</Correction></XAxis>
      <YAxis><Description>Engine speed (rpm)</Description><Units>rpm</Units></YAxis>
      <ZAxis><Description>Duration (crankshaft degrees)</Description></ZAxis>
    </Metadata>
  </MapRule>

  <MapRule priority="110" id="injection_dynamic_advance_448">
    <Conditions>
      <Length>448</Length>
      <MapSelector numRepeats="5" />
      <XAxisID high="0xF9" /><YAxisID high="0xEB" />
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category><Subcategory>Fuel</Subcategory>
      <Name sequential="true" baseName="Injection dynamic advance map (XML)" codeBlockScoped="true" />
      <Correction>0.023437</Correction><Offset>-78</Offset>
      <XAxis><Description>Requested Quantity mg/stroke</Description><Units>mg/st</Units><Correction>0.01</Correction></XAxis>
      <YAxis><Description>Engine speed (rpm)</Description><Units>rpm</Units></YAxis>
      <ZAxis><Description>Duration (crankshaft degrees)</Description></ZAxis>
    </Metadata>
  </MapRule>

  <MapRule priority="111" id="injection_iat_corr_448">
    <Conditions>
      <Length>448</Length>
      <MapSelector numRepeats="4" />
      <XAxisID high="0xF9" /><YAxisID high="0xEB" />
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category><Subcategory>Fuel</Subcategory>
      <Name sequential="true" baseName="Injection correction map (Air Temperature) (XML)" codeBlockScoped="true" />
      <Correction>0.023437</Correction>
      <XAxis><Description>Requested Quantity mg/stroke</Description><Units>mg/st</Units><Correction>0.01</Correction></XAxis>
      <YAxis><Description>Engine speed (rpm)</Description><Units>rpm</Units></YAxis>
      <ZAxis><Description>Duration (crankshaft degrees)</Description></ZAxis>
    </Metadata>
  </MapRule>

  <!-- 5. Injector Duration (ID) - Generic lengths -->
  <MapRule priority="120" id="injector_duration_generic">
    <Description>
      Injector duration map - Various dimensions
      Based on legacy EDC15PFileParser.cs logic for multiple lengths.
      Higher priority rules handle SOI/BIP/etc. to avoid collisions.
    </Description>
    <Conditions>
      <Or>
        <Conditions>
          <Length>570</Length>
          <Or>
            <Conditions><XAxisID high="0xC5" /><YAxisID high="0xEC" /></Conditions>
            <Conditions><XAxisID high="0xC4" /><YAxisID high="0xEA" /></Conditions>
            <Conditions><XAxisID high="0xC4" /><YAxisID high="0xEC" /></Conditions>
          </Or>
        </Conditions>
        <Conditions>
          <Length>480</Length>
          <Or>
            <Conditions><XAxisID high="0xC5" /><YAxisID high="0xEC" /></Conditions>
            <Conditions><XAxisID high="0xC4" /><YAxisID high="0xEA" /></Conditions>
            <Conditions><XAxisID high="0xC4" /><YAxisID high="0xEC" /></Conditions>
          </Or>
        </Conditions>
        <Conditions>
          <Length>448</Length>
          <Or>
            <Conditions><XAxisID high="0xC5" /><YAxisID high="0xEC" /></Conditions>
            <Conditions><XAxisID high="0xC4" /><YAxisID high="0xEA" /></Conditions>
            <Conditions><XAxisID high="0xC4" /><YAxisID high="0xEC" /></Conditions>
          </Or>
        </Conditions>
        <Conditions>
          <Length>390</Length><XAxisLength>13</XAxisLength><YAxisLength>15</YAxisLength>
          <Or>
            <Conditions><XAxisID high="0xC5" /><YAxisID high="0xEC" /></Conditions>
            <Conditions><XAxisID high="0xC4" /><YAxisID high="0xEA" /></Conditions>
            <Conditions><XAxisID high="0xC4" /><YAxisID high="0xEC" /></Conditions>
          </Or>
        </Conditions>
        <Conditions>
          <Length>360</Length><XAxisLength>12</XAxisLength><YAxisLength>15</YAxisLength>
          <Or>
            <Conditions><XAxisID high="0xC5" /><YAxisID high="0xEC" /></Conditions>
            <Conditions><XAxisID high="0xC4" /><YAxisID high="0xEA" /></Conditions>
            <Conditions><XAxisID high="0xC4" /><YAxisID high="0xEC" /></Conditions>
          </Or>
        </Conditions>
        <Conditions>
          <Length>260</Length>
          <Or>
            <Conditions><XAxisID high="0xC5" /><YAxisID high="0xEC" /></Conditions>
            <Conditions><XAxisID high="0xC4" /><YAxisID high="0xEA" /></Conditions>
            <Conditions><XAxisID high="0xC4" /><YAxisID high="0xEC" /></Conditions>
          </Or>
        </Conditions>
        <Conditions>
          <Length>220</Length>
          <Or>
            <Conditions><XAxisID high="0xC5" /><YAxisID high="0xEC" /></Conditions>
            <Conditions><XAxisID high="0xC4" /><YAxisID high="0xEA" /></Conditions>
            <Conditions><XAxisID high="0xC4" /><YAxisID high="0xEC" /></Conditions>
          </Or>
        </Conditions>
        <Conditions>
          <Length>200</Length><AxisValueCheck axis="X" comparison="gt" value="3500" checkType="max" />
          <Or>
            <Conditions><XAxisID high="0xC5" /><YAxisID high="0xEC" /></Conditions>
            <Conditions><XAxisID high="0xC4" /><YAxisID high="0xEA" /></Conditions>
            <Conditions><XAxisID high="0xC4" /><YAxisID high="0xEC" /></Conditions>
          </Or>
        </Conditions>
        <Conditions>
          <Length>198</Length>
          <Or>
            <Conditions><XAxisID high="0xC5" /><YAxisID high="0xEC" /></Conditions>
            <Conditions><XAxisID high="0xC4" /><YAxisID high="0xEA" /></Conditions>
            <Conditions><XAxisID high="0xC4" /><YAxisID high="0xEC" /></Conditions>
          </Or>
        </Conditions>
        <Conditions>
          <Length>180</Length>
          <Or>
            <Conditions><XAxisID high="0xC5" /><YAxisID high="0xEC" /></Conditions>
            <Conditions><XAxisID high="0xC4" /><YAxisID high="0xEA" /></Conditions>
            <Conditions><XAxisID high="0xC4" /><YAxisID high="0xEC" /></Conditions>
          </Or>
        </Conditions>
        <Conditions>
          <Length>160</Length><XAxisLength>8</XAxisLength><YAxisLength>10</YAxisLength>
          <Or>
            <Conditions><XAxisID high="0xC5" /><YAxisID high="0xEC" /></Conditions>
            <Conditions><XAxisID high="0xC4" /><YAxisID high="0xEA" /></Conditions>
            <Conditions><XAxisID high="0xC4" /><YAxisID high="0xEC" /></Conditions>
          </Or>
        </Conditions>
      </Or>
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category>
      <Subcategory>Fuel</Subcategory>
      <Name sequential="true" baseName="Injector duration (XML)" codeBlockScoped="true" />
      <Correction>0.023437</Correction>
      <XAxis>
        <Description>Engine speed (rpm)</Description>
        <Units>rpm</Units>
      </XAxis>
      <YAxis>
        <Description>Requested Quantity mg/stroke</Description>
        <Units>mg/st</Units>
        <Correction>0.01</Correction>
      </YAxis>
      <ZAxis>
        <Description>Duration (crankshaft degrees)</Description>
      </ZAxis>
    </Metadata>
  </MapRule>

  <!-- 6. Boost Target -->
  <MapRule priority="130" id="boost_target_320">
    <Description>
      Boost target map - 10x16 dimension (320 bytes)
    </Description>
    <Conditions>
      <Length>320</Length>
      <Or>
        <Conditions><XAxisID high="0xEC" /><YAxisID high="0xC0" /></Conditions>
        <Conditions><XAxisID high="0xEA" /><YAxisID high="0xC0" /></Conditions>
      </Or>
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category>
      <Subcategory>Turbo</Subcategory>
      <Name>Boost target map (XML)</Name>
      <XAxis>
        <Description>IQ (mg/stroke)</Description>
        <Units>mg/st</Units>
        <Correction>0.01</Correction>
      </XAxis>
      <YAxis>
        <Description>Engine speed (rpm)</Description>
        <Units>rpm</Units>
      </YAxis>
      <ZAxis>
        <Description>Boost target (mbar)</Description>
      </ZAxis>
    </Metadata>
  </MapRule>

  <!-- 7. Smoke Limiter / IQ by MAP/MAF Limiters (Length 416/384) -->
  <MapRule priority="140" id="smoke_limiter_generic">
    <Description>Smoke limiter (IQ by MAF) - Axis IDs: F9/DA or EA/DA (Legacy parser:1511, 1777)</Description>
    <Conditions>
      <Or>
        <Conditions><Length>416</Length><XAxisID high="0xF9" /><YAxisID high="0xDA" /></Conditions>
        <Conditions><Length>384</Length><XAxisLength>16</XAxisLength><YAxisLength>12</YAxisLength><XAxisID high="0xEA" /><YAxisID high="0xDA" /></Conditions>
      </Or>
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category>
      <Subcategory>Limiters</Subcategory>
      <Name sequential="false" codeBlockScoped="true">
        <ConditionalTemplate>
          <When conditionType="MapSelectorExists">
            <Template>Smoke limiter {temperature} deg C (XML)</Template>
          </When>
          <When conditionType="default">
            <Template>Smoke limiter (XML)</Template>
          </When>
        </ConditionalTemplate>
      </Name>
      <Correction>0.01</Correction>
      <XAxis><Description>Airflow mg/stroke</Description><Units>mg/st</Units><Correction>0.1</Correction></XAxis>
      <YAxis><Description>Engine speed (rpm)</Description><Units>rpm</Units></YAxis>
      <ZAxis><Description>Maximum IQ (mg)</Description></ZAxis>
    </Metadata>
  </MapRule>

  <!-- 7.1 Torque Limiter -->
  <MapRule priority="142" id="torque_limiter_generic">
    <Description>Torque limiter (Legacy:3157, 3109, 3125...)</Description>
    <Conditions>
      <XAxisLength>3</XAxisLength>
      <Or>
        <Conditions><Length>150</Length><YAxisLength>25</YAxisLength></Conditions>
        <Conditions><Length>144</Length><YAxisLength>24</YAxisLength></Conditions>
        <Conditions><Length>138</Length><YAxisLength>23</YAxisLength></Conditions>
        <Conditions><Length>132</Length><YAxisLength>22</YAxisLength></Conditions>
        <Conditions><Length>126</Length><YAxisLength>21</YAxisLength></Conditions>
        <Conditions><Length>120</Length><YAxisLength>20</YAxisLength></Conditions>
      </Or>
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category><Subcategory>Limiters</Subcategory>
      <Name sequential="true" baseName="Torque limiter (XML)" codeBlockScoped="true" />
      <Correction>0.01</Correction>
      <XAxis><Description>Engine speed (rpm)</Description><Units>rpm</Units></XAxis>
      <YAxis><Description>Atm. pressure (mbar)</Description><Units>mbar</Units></YAxis>
      <ZAxis><Description>Maximum IQ (mg)</Description></ZAxis>
    </Metadata>
  </MapRule>

  <!-- 7.2 Torque Limiter - Min map -->
  <MapRule priority="143" id="torque_limiter_min">
    <Description>Torque limiter - Min map (mrwADB_KF) (Legacy:5742)</Description>
    <Conditions>
      <Length>8</Length><XAxisLength>2</XAxisLength><YAxisLength>2</YAxisLength>
      <XAxisID high="0xC2" /><YAxisID high="0xEC" />
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category><Subcategory>Limiters</Subcategory>
      <Name>Torque limiter - Min map (XML)</Name>
      <Correction>0.01</Correction>
      <XAxis><Description>Speed/rpm ratio (km/h per rpm)</Description><Units>km/h/rpm</Units></XAxis>
      <YAxis><Description>Engine speed (rpm)</Description><Units>rpm</Units></YAxis>
      <ZAxis><Description>Torque limit (mg/stroke)</Description></ZAxis>
    </Metadata>
  </MapRule>

  <MapRule priority="144" id="torque_limiter_min_pi">
    <Description>Torque limiter - Min map PI (mrwADB2_KF) (Legacy:5742)</Description>
    <Conditions>
      <Length>8</Length><XAxisLength>2</XAxisLength><YAxisLength>2</YAxisLength>
      <XAxisID high="0xC2" /><YAxisID high="0xEC" />
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category><Subcategory>Limiters</Subcategory>
      <Name>Torque limiter - Min map PI (XML)</Name>
      <Correction>0.01</Correction>
      <XAxis><Description>Speed/rpm ratio (km/h per rpm)</Description><Units>km/h/rpm</Units></XAxis>
      <YAxis><Description>Engine speed (rpm)</Description><Units>rpm</Units></YAxis>
      <ZAxis><Description>Torque limit (mg/stroke)</Description></ZAxis>
    </Metadata>
  </MapRule>

  <!-- 7.3 SOI Limiter (Temperature) -->
  <MapRule priority="146" id="soi_limiter_temp">
    <Description>SOI limiter (temperature) (Legacy:1945)</Description>
    <Conditions>
      <Length>308</Length><XAxisLength>14</XAxisLength><YAxisLength>11</YAxisLength>
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category><Subcategory>Limiters</Subcategory>
      <Name>SOI limiter (temperature) (XML)</Name>
      <Correction>-0.023437</Correction><Offset>78</Offset>
      <XAxis><Description>Temperature</Description><Units>°C</Units><Correction>0.1</Correction><Offset>-273.1</Offset></XAxis>
      <YAxis><Description>Engine speed (rpm)</Description><Units>rpm</Units></YAxis>
      <ZAxis><Description>SOI limit (degrees)</Description></ZAxis>
    </Metadata>
  </MapRule>

  <MapRule priority="145" id="iq_by_map_limiter">
    <Description>IQ by MAP limiter - Axis IDs: EC/DA, Max(Y) under 4000 (Legacy parser:1542)</Description>
    <Conditions>
      <Or>
        <Conditions><Length>416</Length></Conditions>
        <Conditions><Length>320</Length></Conditions>
      </Or>
      <XAxisID high="0xEC" /><YAxisID high="0xDA" />
      <AxisValueCheck axis="Y" comparison="lt" value="4000" checkType="max" />
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category><Subcategory>Limiters</Subcategory>
      <Name>IQ by MAP limiter (XML)</Name>
      <Correction>0.01</Correction>
      <XAxis><Description>Boost pressure</Description><Units>mbar</Units></XAxis>
      <YAxis><Description>Engine speed (rpm)</Description><Units>rpm</Units></YAxis>
      <ZAxis><Description>Maximum IQ (mg)</Description></ZAxis>
    </Metadata>
  </MapRule>

  <MapRule priority="148" id="iq_by_maf_limiter">
    <Description>IQ by MAF limiter - Axis IDs: EC/DA, Max(Y) over 4000 (Legacy parser:1560)</Description>
    <Conditions>
      <Or>
        <Conditions><Length>416</Length></Conditions>
        <Conditions><Length>384</Length></Conditions>
      </Or>
      <XAxisID high="0xEC" /><YAxisID high="0xDA" />
      <AxisValueCheck axis="Y" comparison="ge" value="4000" checkType="max" />
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category><Subcategory>Limiters</Subcategory>
      <Name>IQ by MAF limiter (XML)</Name>
      <Correction>0.01</Correction>
      <XAxis><Description>Airflow mg/stroke</Description><Units>mg/st</Units><Correction>0.1</Correction></XAxis>
      <YAxis><Description>Engine speed (rpm)</Description><Units>rpm</Units></YAxis>
      <ZAxis><Description>Maximum IQ (mg)</Description></ZAxis>
    </Metadata>
  </MapRule>

  <MapRule priority="150" id="inverse_driver_wish_384">
    <Description>Inverse driver wish - 12x16 dimension (384 bytes) (Legacy parser:1763)</Description>
    <Conditions>
      <Length>384</Length>
      <XAxisLength>12</XAxisLength>
      <YAxisLength>16</YAxisLength>
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category><Subcategory>Misc</Subcategory>
      <Name>Inverse driver wish (XML)</Name>
      <Correction>0.01</Correction>
      <XAxis><Description>IQ (mg/stroke)</Description><Units>mg/st</Units><Correction>0.01</Correction></XAxis>
      <YAxis><Description>Engine speed (rpm)</Description><Units>rpm</Units></YAxis>
      <ZAxis><Description>Throttle position</Description></ZAxis>
    </Metadata>
  </MapRule>

  <MapRule priority="155" id="n75_duty_cycle_generic">
    <Description>N75 duty cycle map (Legacy parser:1575, 1604, 1677, 1867)</Description>
    <Conditions>
      <Or>
        <Conditions><Length>416</Length></Conditions>
        <Conditions><Length>352</Length></Conditions>
      </Or>
      <XAxisID high="0xEC" />
      <Or>
        <Conditions><YAxisID high="0xEA" /></Conditions>
        <Conditions><YAxisID exact="0xE9D4" /></Conditions>
      </Or>
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category><Subcategory>Turbo</Subcategory>
      <Name>N75 duty cycle (XML)</Name>
      <Correction>-0.01</Correction><Offset>100</Offset>
      <XAxis><Description>IQ (mg/stroke)</Description><Units>mg/st</Units><Correction>0.01</Correction></XAxis>
      <YAxis><Description>Engine speed (rpm)</Description><Units>rpm</Units></YAxis>
      <ZAxis><Description>Duty cycle %</Description></ZAxis>
    </Metadata>
  </MapRule>

  <!-- 7.3 MAF correction by temperature -->
  <MapRule priority="165" id="maf_correction_temp">
    <Description>MAF correction by temperature (Legacy:2640)</Description>
    <Conditions>
      <Length>128</Length><XAxisLength>8</XAxisLength><YAxisLength>8</YAxisLength>
      <Or>
        <Conditions><XAxisID high="0xEC" /></Conditions>
        <Conditions><XAxisID high="0xEA" /></Conditions>
      </Or>
      <YAxisID high="0xC1" />
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category><Subcategory>Limiters</Subcategory>
      <Name sequential="true" baseName="MAF correction by temperature (XML)" codeBlockScoped="true" />
      <Correction>0.01</Correction>
      <XAxis><Description>Intake air temperature</Description><Units>°C</Units><Correction>0.1</Correction><Offset>-273.1</Offset></XAxis>
      <YAxis><Description>Engine speed (rpm)</Description><Units>rpm</Units></YAxis>
      <ZAxis><Description>Limit</Description></ZAxis>
    </Metadata>
  </MapRule>

  <!-- 8. EGR Map with Zero-Check -->
  <MapRule priority="160" id="egr_map_generic">
    <Description>EGR map with dimension checks to prevent collisions (Legacy parser:1620, 1745, 1808, 1852)</Description>
    <Conditions>
      <Or>
        <Conditions><Length>416</Length><XAxisLength>16</XAxisLength><YAxisLength>13</YAxisLength></Conditions>
        <Conditions><Length>390</Length><XAxisLength>15</XAxisLength><YAxisLength>13</YAxisLength></Conditions>
        <Conditions><Length>384</Length><XAxisLength>16</XAxisLength><YAxisLength>12</YAxisLength></Conditions>
        <Conditions><Length>352</Length><XAxisLength>16</XAxisLength><YAxisLength>11</YAxisLength></Conditions>
      </Or>
      <XAxisID high="0xEC" />
      <Or>
        <Conditions><YAxisID high="0xC0" /></Conditions>
        <Conditions><YAxisID high="0xE9" /></Conditions>
      </Or>
      <ByteCheck address="y_axis_address" offset="0" expected="0x00" op="eq" />
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category><Subcategory>Misc</Subcategory>
      <Name sequential="true" baseName="EGR (XML)" codeBlockScoped="true" />
      <Correction>0.1</Correction>
      <XAxis><Description>IQ (mg/stroke)</Description><Units>mg/st</Units><Correction>0.01</Correction></XAxis>
      <YAxis><Description>Engine speed (rpm)</Description><Units>rpm</Units></YAxis>
      <ZAxis><Description>Mass Air Flow (mg/stroke)</Description></ZAxis>
    </Metadata>
  </MapRule>

  <!-- 9. Driver Wish Map -->
  <MapRule priority="200" id="driver_wish_generic">
    <Conditions>
      <Or>
        <Conditions><Length>286</Length><XAxisLength>13</XAxisLength><YAxisLength>11</YAxisLength></Conditions>
        <Conditions><Length>256</Length></Conditions>
        <Conditions><Length>240</Length><XAxisLength>12</XAxisLength><YAxisLength>10</YAxisLength></Conditions>
        <Conditions><Length>216</Length><XAxisLength>12</XAxisLength><YAxisLength>9</YAxisLength></Conditions>
        <Conditions><Length>192</Length><XAxisID high="0xEC" /><YAxisID high="0xC0" /></Conditions>
      </Or>
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category><Subcategory>Misc</Subcategory>
      <Name>Driver wish (XML)</Name>
      <Correction>0.01</Correction>
      <XAxis><Description>Throttle position</Description><Units>TPS %</Units><Correction>0.01</Correction></XAxis>
      <YAxis><Description>Engine speed (rpm)</Description><Units>rpm</Units></YAxis>
      <ZAxis><Description>Requested IQ (mg)</Description></ZAxis>
    </Metadata>
  </MapRule>


  <!-- 10. Expected Fuel Temp / Boost Correction -->
  <MapRule priority="215" id="boost_correction_water_temp">
    <Description>Boost correction by water temperature (ldwTW_KF) (Legacy parser:2673)</Description>
    <Conditions>
      <Length>128</Length><XAxisLength>8</XAxisLength><YAxisLength>8</YAxisLength>
      <Or>
        <Conditions><XAxisID high="0xEA" /></Conditions>
        <Conditions><XAxisID high="0xEB" /></Conditions>
      </Or>
      <YAxisID high="0xC0" />
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category><Subcategory>Limiters</Subcategory>
      <Name>Boost correction by water temperature (XML)</Name>
      <Correction>0.01</Correction>
      <!-- Axis descriptions swapped to match legacy parser viewer orientation -->
      <XAxis><Description>IQ (mg/stroke)</Description><Units>mg/st</Units><Correction>0.01</Correction></XAxis>
      <YAxis><Description>Temperature (°C)</Description><Units>°C</Units><Correction>0.1</Correction><Offset>-273.1</Offset></YAxis>
      <ZAxis><Description>Limitation of Boost (in %)</Description></ZAxis>
    </Metadata>
  </MapRule>

  <MapRule priority="216" id="expected_fuel_temp">
    <Description>Expected fuel temperature (zmwMKBT_KF) (Legacy parser:2709)</Description>
    <Conditions>
      <Length>128</Length><XAxisLength>8</XAxisLength><YAxisLength>8</YAxisLength>
      <XAxisID high="0xEC" />
      <YAxisID high="0xC0" />
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category><Subcategory>Limiters</Subcategory>
      <Name>Expected fuel temperature (XML)</Name>
      <Correction>0.1</Correction><Offset>-273.1</Offset>
      <XAxis><Description>IQ (mg/stroke)</Description><Units>mg/st</Units><Correction>0.01</Correction></XAxis>
      <YAxis><Description>Engine speed (rpm)</Description><Units>rpm</Units></YAxis>
      <ZAxis><Description>Fuel temperature °C</Description></ZAxis>
    </Metadata>
  </MapRule>

  <!-- 11. Fuel Temperature Protection -->
  <MapRule priority="220" id="fuel_temp_protection_mrwBKT">
    <Conditions>
      <Length>200</Length>
      <Or>
        <Conditions><XAxisID exact="0xC1AE" /><YAxisID high="0xEC" /></Conditions>
        <Conditions><XAxisID exact="0xC178" /><YAxisID high="0xEC" /></Conditions>
        <Conditions><XAxisID exact="0xC1BE" /><YAxisID high="0xEC" /></Conditions>
      </Or>
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category><Subcategory>Limiters</Subcategory>
      <Name>Fuel Temperature overheating protection map (mrwBKT_KF) (XML)</Name>
      <Correction>0.0001</Correction>
      <XAxis><Description>Engine speed (rpm)</Description><Units>rpm</Units></XAxis>
      <YAxis><Description>Fuel temperature (°C)</Description><Units>°C</Units><Correction>0.1</Correction><Offset>-273.1</Offset></YAxis>
      <ZAxis><Description>Correction</Description></ZAxis>
    </Metadata>
  </MapRule>

  <MapRule priority="222" id="fuel_temp_protection_mrwBTT">
    <Conditions>
      <Length>200</Length>
      <Or>
        <Conditions><XAxisID exact="0xC1CE" /><YAxisID high="0xEC" /></Conditions>
        <Conditions><XAxisID exact="0xC198" /><YAxisID high="0xEC" /></Conditions>
        <Conditions><XAxisID exact="0xC1DE" /><YAxisID high="0xEC" /></Conditions>
      </Or>
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category><Subcategory>Limiters</Subcategory>
      <Name>Fuel tank inlet temp overheat protection map (mrwBTT_KF) (XML)</Name>
      <Correction>0.0001</Correction>
      <XAxis><Description>Engine speed (rpm)</Description><Units>rpm</Units></XAxis>
      <YAxis><Description>Fuel temperature (°C)</Description><Units>°C</Units><Correction>0.1</Correction><Offset>-273.1</Offset></YAxis>
      <ZAxis><Description>Correction</Description></ZAxis>
    </Metadata>
  </MapRule>

  <!-- 11.1 Turbo Protection / Limits -->
  <MapRule priority="225" id="overboost_debouncing">
    <Description>Overboost debouncing limit (zmwVETSuKF) (Legacy:2220)</Description>
    <Conditions>
      <Length>200</Length><XAxisLength>10</XAxisLength><YAxisLength>10</YAxisLength>
      <XAxisID high="0xEC" /><YAxisID high="0xEC" />
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category><Subcategory>Limiters</Subcategory>
      <Name>Overboost debouncing limit (XML)</Name>
      <Correction>10</Correction>
      <XAxis><Description>Engine speed (rpm)</Description><Units>rpm</Units></XAxis>
      <YAxis><Description>Pressure of the boost overrrun (mbar)</Description><Units>mbar</Units></YAxis>
      <ZAxis><Description>Turbo debouncing time (ms)</Description></ZAxis>
    </Metadata>
  </MapRule>

  <MapRule priority="228" id="overboost_protection_limit">
    <Description>Limit of overboost protection (zmwVEPLSKF) (Legacy:2207)</Description>
    <Conditions>
      <Length>200</Length><XAxisLength>10</XAxisLength><YAxisLength>10</YAxisLength>
      <XAxisID high="0xEC" />
      <Or>
        <Conditions><YAxisID high="0xC2" /></Conditions>
        <Conditions><YAxisID high="0xC1" /></Conditions>
      </Or>
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category><Subcategory>Limiters</Subcategory>
      <Name>Limit of overboost protection (XML)</Name>
      <Correction>1</Correction>
      <XAxis><Description>Engine speed (rpm)</Description><Units>rpm</Units></XAxis>
      <YAxis><Description>VNT Actuator Duty Cycle (%)</Description><Units>%</Units><Correction>0.01</Correction></YAxis>
      <ZAxis><Description>Pressure limit (mbar)</Description></ZAxis>
    </Metadata>
  </MapRule>

  <!-- 11.2 IQ by Air Intake Temp -->
  <MapRule priority="229" id="iq_by_iat">
    <Description>IQ by air intake temp (Legacy parser:4611)</Description>
    <Conditions>
      <Length min="18" max="70" />
      <!-- Legacy restricts to 0xC1Ax and 0xEC3x -->
      <Or>
        <Conditions><XAxisID exact="0xC1A6" /></Conditions>
        <Conditions><XAxisID exact="0xC1AC" /></Conditions>
      </Or>
      <YAxisID high="0xEC" />
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category><Subcategory>Limiters</Subcategory>
      <Name>IQ by air intake temp (XML)</Name>
      <Correction>0.01</Correction>
      <!-- Axis descriptions swapped to match legacy parser viewer orientation -->
      <XAxis><Description>Engine speed (rpm)</Description><Units>rpm</Units></XAxis>
      <YAxis><Description>Temperature</Description><Units>°C</Units><Correction>0.1</Correction><Offset>-273.1</Offset></YAxis>
      <ZAxis><Description>%</Description></ZAxis>
    </Metadata>
  </MapRule>

  <!-- 12. Boost Limit Map -->
  <MapRule priority="230" id="boost_limit_200">
    <Conditions>
      <Description>Boost limit map - 10x10 dimension (200 bytes)</Description>
      <Or>
        <Conditions><Length>200</Length><XAxisLength>10</XAxisLength><YAxisLength>10</YAxisLength></Conditions>
        <Conditions><Length>180</Length><XAxisLength>9</XAxisLength><YAxisLength>10</YAxisLength></Conditions>
      </Or>
      <XAxisID high="0xC0" />
      <Or>
        <Conditions><YAxisID high="0xEC" /></Conditions>
        <Conditions><YAxisID high="0xEA" /></Conditions>
      </Or>
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category><Subcategory>Limiters</Subcategory>
      <Name>Boost limit map (XML)</Name>
      <XAxis><Description>Engine speed (rpm)</Description><Units>rpm</Units></XAxis>
      <YAxis><Description>Atmospheric pressure (mbar)</Description><Units>mbar</Units></YAxis>
      <ZAxis><Description>Maximum boost pressure (mbar)</Description></ZAxis>
    </Metadata>
  </MapRule>

  <!-- 13. Boost correction by temperature -->
  <MapRule priority="240" id="boost_correction_temp_da">
    <Description>Boost correction by temperature (Legacy:6036)</Description>
    <Conditions>
      <XAxisID exact="0xDA6C" /><YAxisID exact="0xDA6A" />
    </Conditions>
    <Metadata>
      <Category>Detected maps</Category><Subcategory>Limiters</Subcategory>
      <Name>Boost correction by temperature (XML)</Name>
      <XAxis><Description>IAT (celcius)</Description><Units>°C</Units><Correction>0.1</Correction><Offset>-273.1</Offset></XAxis>
      <YAxis><Description>Requested boost</Description><Units>mbar</Units></YAxis>
      <ZAxis><Description>Boost limit (mbar)</Description></ZAxis>
    </Metadata>
  </MapRule>

</MapRules>
